<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>Resumen de Invitaci√≥n</title>
    <style>
      body {
        font-family: "Montserrat", sans-serif;
        background: #f0f4ff;
        max-width: 600px;
        margin: 2rem auto;
        padding: 1rem;
      }
      .card {
        background: #fff;
        padding: 2rem;
        border-radius: 15px;
        box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
      }
      h1,
      h2 {
        text-align: center;
      }
      .stats {
        display: flex;
        justify-content: space-around;
        margin-top: 1rem;
        background: #d1d4f8;
        border-radius: 10px;
      }
      .stat {
        
        padding: 1rem;
        
        width: 30%;
        text-align: center;
      }
      table {
        width: 100%;
        margin-top: 1rem;
        border-collapse: collapse;
      }
      th,
      td {
        border: 1px solid #ccc;
        padding: 0.5rem;
        text-align: center;
      }
    </style>
  </head>
  <body>
    <div class="card">
      <h1 id="title"></h1>
      <h2 id="child"></h2>

      <div class="stats">
        <div class="stat">‚úÖ Asistir√°n: <span id="accepted">0</span></div>
        <div class="stat">‚ùå No podr√°n: <span id="declined">0</span></div>
        <div class="stat">ü§î Tal vez: <span id="maybe">0</span></div>
      </div>

      <h3>Total de respuestas: <span id="total">0</span></h3>

      <table>
        <thead>
          <tr>
            <th>ID</th>
            <th>Estado</th>
            <th>Fecha</th>
          </tr>
        </thead>
        <tbody id="responsesTable"></tbody>
      </table>
    </div>

    <script>
      const slug = window.location.pathname.split("/").pop();

      async function loadSummary() {
        const res = await fetch(`/api/invitations/${slug}/responses`);
        const data = await res.json();

        document.getElementById("title").textContent =
          data.title || "Invitaci√≥n";
        document.getElementById("child").textContent = data.child_name;

        document.getElementById("accepted").textContent = data.accepted;
        document.getElementById("declined").textContent = data.declined;
        document.getElementById("maybe").textContent = data.maybe;
        document.getElementById("total").textContent = data.total;

        const tbody = document.getElementById("responsesTable");
        tbody.innerHTML = "";
        data.responses.forEach((r) => {
          const tr = document.createElement("tr");
          tr.innerHTML = `<td>${r.id}</td>
<td>${
            r.status === "accepted"
              ? "‚úÖ Asistir√°"
              : r.status === "declined"
              ? "‚ùå No podr√°"
              : "ü§î Tal vez"
          }</td>
<td>${
            r.responded_at
              ? new Date(r.responded_at).toLocaleString("es-AR")
              : ""
          }</td>`;
          tbody.appendChild(tr);
        });
      }

      loadSummary();
    </script>
  </body>
</html>
